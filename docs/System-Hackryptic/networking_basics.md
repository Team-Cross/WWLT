
# Table of Contents

1.  [LAN](#org3601a32)
2.  [WAN](#org2a4da93)
3.  [VPN](#org6bbd21a)
4.  [Network Topolgies](#orgf4842ad)
5.  [Proxy](#orgb756589)
6.  [OSI Layer Model](#orgc1950ec)
7.  [TCP/IP Model](#org1c9cf9f)
8.  [Data Transfer](#orgdc92443)
9.  [Network Layer](#org9592e83)
10. [IPv4 주소체계](#org25a8e0e)
11. [MAC Address](#org0276700)

\#-**- mode: org -**-

본 포스트는 HackTheBox 아카데미의 Introduction to Network 부분을 공부하며 정리한 내용입니다.


<a id="org3601a32"></a>

# LAN

-   호스트들 사이에 소규모로 연결된 지역 네트워크
-   RFC 1918에서 정의된 사설망 주소체계(10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16)를 따른다.
-   특정 LAN에 소속되기 위한 IP를 따로 부여받는 경우도 있다.
-   WLAN은 무선 데이터로 통신 가능한 LAN이다.


<a id="org2a4da93"></a>

# WAN

-   LAN 사이의 광대한 네트워크
-   내부망(Intranet)으로 구축하는 경우도 있다.
-   BGP 라우팅 프로토콜 및 ip 주소가 RFC 1918에서 제시된 사설망 주소를 따르는 지 여부를 확인하면, 네트워크가 WAN인지 확인할 수 있다.


<a id="org6bbd21a"></a>

# VPN

-   Virtual Private Network
-   Site-To-Site VPN: 서버와 클라이언트가 네트워크 장비(라우터, 방화벽 등)로 이루어진 망으로서 인터넷으로 연결된 호스트들이 LAN처럼 통신할 수 있다.
-   Remote Access VPN: 클라이언트가 가상 네트워크 인터페이스를 생성하여 VPN 서버에서 가상으로 만든 네트워크를 통해 원격 호스트로 통신할 수 있다.
-   SSL VPN: TLS를 사용하여 HTTP 혹은 HTTPS을 통해 구축한 가상의 망을 구축하고, 클라이언트는 웹 브라우저로 접근할 수 있다.


<a id="orgf4842ad"></a>

# Network Topolgies

-   point-to-point: 호스트 2개가 직접 점대점으로 연결
-   bus: 별도의 네트워크 장비없이 전송매체(동축 케이블 등)를 중심으로 각 호스트가 연결된 형태 (한번에 한 호스트만 데이터를 전송할 수 있다. 데이터를 수신하는 호스트들에서는 자신에게 온 데이터가 맞는지 직접 확인)
-   star: 각 호슽가 네트워크 장비(라우터, 스위치, 허브 등)에 연결된 형태로 장비는 데이터 패킷을 포워딩한다. 각 호스트가 제한없이 데이터를 전송할 수 있기 때문에 네트워크 트래픽 양이 매우 많아 질 수 있다.
-   ring: 종단점이 없이 네트워크가 서로 인접한 네트워크들과 연결된 형태. (물리적 연결의 경우 들어오고 나가는 데이터를 위한 케이블이 각각 한 개씩 필요하다.) token을 가진 호스트가 데이터를 전송할 수 있다.
-   mesh: 메시 구조는 어떻게 구성하느냐에 따라서 네트워크의 형태가 달라질 수 있다. 각 노드는 다수의 연결을 가질 수 있다. (정형화되지 않음) 각 호스트는 여러 개의 호스트와 네트워크 장비로 구성된 메쉬 네트워크에 연결된다. 부분적 메쉬 구조는 종단점에서 하나의 연결만을 가지고 있다.
-   tree: 각 노드가 트리 계층 구조로 연결되며, 트리를 구성하는 작은 네트워크들은 작은 트리 형태이거나 다른 네트워크 토폴로지 형태를 가질 수 있다.
-   hybrid: 특정 토폴로지에 구애받지 않는 다양한 구조들을 총칭한다. 여러개의 다른 토폴로지가 연결된 형태일 수도 있다.
-   daisy chain: 각 호스트들이 인접한 호스트와 연결된 형태이다. ring 형태와는 다르게 물리적인 연결로만 구성이 가능하고 endpoint인 노드들이 존재한다. 각 노드들은 이전 노드에서 전송된 데이터를 단순히 다음 노드로 연결한다.


<a id="orgb756589"></a>

# Proxy

-   연결의 중간에서 중간자 역할을 수행하는 장비 혹은 서비스
-   중간에서 네트워크 트래픽의 데이터를 분석한다. (이 기능이 없으면 그저 gateway로써 취급)
-   OSI 7계층(애플리케이션 계층)에서 동작한다.

-   프록시의 종류
    -   Dedicated / Forward Proxy: 클라이언트가 프록시 서버로 동작하는 특정 장비(PC 포함)에 요청을 보내면 해당 장비는 데이터를 forwarding한다.
    -   Reverse Proxy: 인바운드 트래픽을 필터링한다. 인터넷을 통해 프록시 서버에 연결하고 필터링을 거친 데이터를 전송받는다.
    -   Transparent proxy: 클라이언트가 인식하지 못하는 상태로 중간자로서 개입하여 프록시의 역할을 한다.


<a id="orgc1950ec"></a>

# OSI Layer Model

-   시스템간의 통신을 표현하기 위해 정의한 모델이다.
-   다른 통신기술 및 다양한 장비를 통해 시스템들이 통신하기 위한 호환성을 제공하려는 목적을 가지고 있다.
-   각각의 고유한 역할을 가진 7개의 계층으로 이루어져 있다.
    1.  Application Layer: 애플리케이션에서 입/출력되는 데이터들을 다루기 위한 계층이다.
    2.  Presentation Layer: 시스템으로부터 독립적인 고유한 형태로 데이터를 표현하기 위한 계층이다.
    3.  Session Layer: 두 시스템 간의 논리적 연결을 유지하고, 연결에 문제가 생기는 일을 방지하기 위한 계층이다.
    4.  Transport Layer: 두 시스템 간의 end-to-end 연결을 기반으로 데이터를 전송하기 위한 계층이다. 혼잡 제어 등의 기능도 보유하고 있다.
    5.  Network Layer: 패킷들을 한 노드로부터 다른 네트워크로 전송하기 위한 방법을 제공한다. 모든 노드들은 IP 주소가 배정되고 데이터 패킷을 전송할 때(라우팅 테이블과 라우팅 알고리즘을 기반으로) 해당 주소로 어떤 경로를 선택할 것인지에 대한 부분을 처리한다.
    6.  Data Link Layer: 직접 연결된 장비와의 점대점 통신에 있어서 신뢰성있는 연결을 제공한다. (에러 교정과 흐름 제어를 담당)
        -   LLC(Logical Link Control) Layer: 네트워크 계층의 프로토콜에 대해 multiplex 및 de-multiplex를 수행한다.
        -   MAC(Media Access Control) Layer: 통신 매체에 어떤 방식으로 접근하고 데이터 프레임을 전송할 것인지에 대한 부분을 담당한다.
    7.  Physical Layer: 전기적 신호, 광신호, 전자기파 등이 직접 전송되는 케이블, NIC, 허브 등의 물리적 장비를 의미한다.


<a id="org1c9cf9f"></a>

# TCP/IP Model

-   TCP와 IP는 인터넷에서 데이터 패킷의 전송을 담당하기 위한 프로토콜이다.
-   "TCP/IP"는 TCP와 IP뿐만 아니라 전송 계층과 인터넷 계층(osi의 경우 네트워크 계층)의 프로토콜 패밀리들은 총칭하는 단어이다.(ICMP, ARP, UDP 등)
-   TCP/IP 모델은 OSI 모델보다 덜 경직되고 데이터 통신을 구현하기 위해 좀 더 단순한 형태의 모델을 제안한다.
-   4개의 계층으로 구성된다.
    1.  Application Layer: 애플리케이션이 송수신하는 데이들을 관리하는 프로토콜들을 정의한다.
    2.  Transport Layer: 응용 계층의 데이터를 전송하기 위한 과정에서 TCP 및 UDP 데이터그램 송수신을 담당한다.
    3.  Internet Layer: 호스트의 주소를 통해 데이터 패킷을 라우팅하고 위한 계층이다.
    4.  Link Layer: TCP/IP 패킷을 실제 통신 매체를 통해 물리적으로 어떻게 전송할 것인지에 대한 부분을 담당한다. TCP/IP는 프레임의 포맷이나, 네트워크 접근 방법, 통신 매체의 종류에 상관없이 동작하도록 설계되었다.

-   TCP/IP이 담당하는 작업들은 다음과 같다.
    -   Logical Addressing: 네트워크와 노드들의 논리 주소(IP address)를 관리한다.
    -   Routing: 데이터 패킷이 출발지로부터 도착지까지 가는 경로롤 설정한다.
    -   Flow Control: 두 노드간의 연결을 관리하고, 전송속도 등을 적절하게 제어한다.
    -   Application Support: Port를 통해 각 프로세스간의 신뢰성있고 정확한 연결 및 통신을 제공한다.
    -   Name Resolution: DNS 서버를 통해 FQDN을 제공함으로써 정해진 이름으로 특정 호스트에 접근하는 것이 가능하다.


<a id="orgdc92443"></a>

# Data Transfer

-   각 계층의 레이어들은 데이터를 각각 다른 형식으로 교환한다.(PDU: Protocol Data Unit)
-   (endpoint를 포함한) 장비들의 각 레이어에서는 정해진 작업을 수행한 뒤 다음 레이어로 보낸다. (송신의 경우에는 하위의 레이어로, 수신의 경우에는 상위의 레이어로 가는 방향)
-   데이터 송신의 경우 각 레이어는 데이터 페이로드에 대한 정보와 데이터 통신에 필요한 정보를 헤더로 추가한 뒤 하위의 레이어로 보낸다.(encapsulation)
-   데이터를 수신하는 경우 각 레이어에 해당하는 헤더를 분석하여 데이터를 unpack한다.


<a id="org9592e83"></a>

# Network Layer

-   데이터 패킷을 바로 다른 네트워크의 호스트에 전달할 수 없기 때문에 라우팅 노드들이 중간에서 경로를 지정해야 한다.
-   논리 주소로 각각의 노드들을 식별하고 라우팅 및 흐름 제어를 수행한다.
-   다른 서브넷에 존재하는 노드로도 데이터 통신이 가능하게 하기 위해 forwarding 기능을 통해 (라우팅에 의해 결정된) 중간 노드들로 데이터 패킷을 연속적으로 보낸다.


<a id="org25a8e0e"></a>

# IPv4 주소체계

-   MAC address를 통해 식별된 장비들은 동일 네트워크 상에서만 데이터 통신을 할 수 있다.
-   각 노드는 인터넷 통신을 위한 주소로써 논리적인 주소인 "IP 주소"가 할당되어야 한다.
-   IPv4 주소는 32-bit의 이진수로 이루어져있다. 각 8-bit는 octet이라고 불리며 0~255의 값을 가진다.

-   IP 주소의 host 부분은 라우터에서 부여하고, 네트워크 부분은 네트워크 관리자(인터넷의 경우 IANA)에 의해 부여된다.
    -   host 주소와 네트워크 주소는 보통 클래스(A~E)에 의해 정의된다. (<https://en.wikipedia.org/wiki/Classful_network> 참고)
    -   각 클래스는 다시 subnetting을 통해 더 작은 네트워크로 나눌 수 있다. (subnet mask를 통해 host 부분과 network 주소 부분을 정의)
    -   서로 다른 네트워크, 장비 및 노드들을 관리하는 라우터에는 gateway 주소가 부여되는데 보통 default gateway 주소는 각 subnet의 첫 번째 호스트로 정의된다.
    -   broadcast 주소는 해당 subnet의 전체 구성원들에게 데이터를 전송하기 위한 주소이다.
        -   호스트 부분의 가장 끝 주소를 사용한다.

-   각 클래스의 고정된 주소체계를 대체하기 위하여 CIDR를 사용한다.
    -   CIDR는 CIDR suffix라는 표현을 사용하여 IP 주소에서 몇 비트를 네트워크 주소로 사용할 것인지 결정한다.
    -   네트워크 부분의 비트 수를 직접 지정할 수 있으므로 class 방식보다 유연한 subnetting이 가능하다.
        -   예) 192.168.123.133/25 &#x2013;> 네트워크 주소는 192.168.123.128


<a id="org0276700"></a>

# MAC Address

-   MAC: Media Access Control
-   네트워크 인터페이스의 물리 주소
-   MAC Address의 여러가지 표준이 존재한다.
    -   Ethernet (IEEE 802.3)
    -   Bluetooth (IEEE 802.15)
    -   WLAN (IEEE 802.11)

-   8-bit인 6개의 octet으로 구성되어 있으며 각 octet은 16진수로 표현한다.
-   앞 쪽의 3 바이트는 OUI로써 vendor의 주소로 정의되고, 뒷부분은 장비의 고유한 individual address이다.

-   통신 대상 노드가 같은 네트워크에 있을시는 MAC Address만으로 식별 가능하다.
    -   다른 네트워크에 속한 경우 default gateway인 라우터의 MAC 주소로 데이터 프레임을 보낸다.

-   라우터는 ARP 프로토콜을 사용하여 IP 주소에 대응하는 MAC 주소를 알 수 있다.

-   첫번째 octet의 마지막 비트는 multicast(1) / unicast(0) 여부를 나타낸다.
    -   Unicast: 패킷을 한 개의 특정한 호스트로만 전송한다.
    -   Multicast: 여러 호스트에 패킷을 전송한다.
    -   Broadcast: 모든 주소의 비트를 1로 설정하면 네트워크의 모든 호스트에 패킷을 전송한다.

